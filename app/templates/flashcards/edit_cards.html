{% extends "layout.html" %}

{% block title %}Edit flashcards - Imago English{% endblock %}

{% block main %}
 <div id="flash-message-container"></div>
{% include "partials/search_bar.html" %}




{% for card in flashcards %}
<div id="card-{{ card.id }}" class="section-box flashcard">
    <form class="flashcard-form" data-card-id="{{ card.id }}" method="POST" action="{{ url_for('flashcard.edit_card', card_id=card.id) }}">
        {{ forms[card.id].hidden_tag() }}
    
        <div class="mb-3">
            {{ forms[card.id].question.label }}
            {{ forms[card.id].question(class="form-control auto-expand flashcard-question") }}
        </div>

        <div class="mb-3">  
            {{ forms[card.id].answer.label }}
            {{ forms[card.id].answer(class="form-control auto-expand flashcard-answer") }}
        </div>
         <div class="mb-3">
              <button type="button"
                      class="btn btn-outline-secondary btn-sm flip-card-btn">
                  Flip question & answer
              </button>
          </div>
        <div class="mb-3"> 
        <span class="tc-status">
              {% if card.reviewed_by_tc %}âœ…Reviewed by teacher{% endif %}
        </span>
        </div>

        <button type="submit" name="action" value="edit" class="btn btn-primary">Edit (Editar)</button>
        <button type="submit" name="action" value="delete" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this flashcard? (Tem certeza que deseja excluir este flashcard?)');">Delete (Excluir)</button>
    </form>
    <hr>
</div>
  
{% endfor %}

<script>
document.addEventListener('DOMContentLoaded', function () {
  document.querySelectorAll('.flip-card-btn').forEach(function (btn) {
    btn.addEventListener('click', function () {
      const form = btn.closest('.flashcard-form');
      if (!form) return;

      const questionField = form.querySelector('.flashcard-question');
      const answerField   = form.querySelector('.flashcard-answer');

      if (!questionField || !answerField) return;

      const temp = questionField.value;
      questionField.value = answerField.value;
      answerField.value = temp;
    });
  });
});
</script>

{% endblock %}

{% block scripts %}
{{ super() }}
<script src="{{ url_for('static', filename='js/flashcard-search.js') }}"></script>
{% endblock %}